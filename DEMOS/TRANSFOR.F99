      program transform
      implicit integer(a-z)
c
c  transform - this program transforms an input file in dis/fix/128 format
c              to an output file in dis/fix/80 or dis/var/80 format.
c
c  calling sequence:
c
c              TRANSFORM [input_file] [output_file][/file]
c
c  input_file  :  name of input file to translate
c  output_file :  name of output file to translate
c  /option     :  /DF80 for dis/fix/80, /DV80 for dis/var/80
c                 (default = dis/fix/80)
c
c  Copyright 1989 by LGMA Products.   Permission to use and post this
c  source on bbs systems, user newsletters, and other non-commercial
c  ventures given.
c
c  Update History:
c
c   v1.0      26-Jun-89       Initial Version
c
      integer *1 command(81), infile(40), oufile(40), buffer(640)
      integer *1 inbuf(128,5), oubuf(80,8), options(40), ovbuf(80)
      common command, buffer
c
      logical fileend               ! a logical variable to declare end file
c
c  following statements equivalence the 640 byte buffer two ways,
c  the first equivalences five 128 byte records to it, the second
c  equivalences eight 80 byte records.
c
      equivalence ( inbuf(1,1), buffer(1) ), (oubuf(1,1), buffer(1))
c
      error = 0                     ! set no error
      write ( 6, 9050 )             ! display banner
      command(1) = 80               ! # of spare bytes in command line
      call cmdstr ( command, error) ! get user command line
      ptr = 2                       ! set command line input pointer
      call getfile ( ptr, infile )  ! get input file name
      call getfile ( ptr, oufile )  ! get output file name
      call getfile ( ptr, options ) ! get any command options
c
c  make sure the two file names are specified
c
      if ( infile(1) .eq. ' ' .or. oufile(1) .eq. ' ' ) then
        write ( 6, 9100 )
        write ( 6, 9110 )
        goto 9999
      endif
c
c  parse the command line option, set disfix according to file option
c
      if ( options(1) .eq. ' ' ) then
        disvar = 0                  ! default
      else if ( options(1) .eq. '/' ) then
        if ( options(2) .eq. 'F' ) then
          disvar = 0
        else if ( options(2) .eq. 'V' ) then
          disvar = 1
        else
          write ( 6, 9180 ) options
          stop
        endif
      else
        write ( 6, 9180 ) options   ! error
        stop
      endif
c
c  Open the input and output files.
c
      if ( disvar .eq. 0 ) then
        write ( 6, 9060 ) infile, oufile
      else
        write ( 6, 9070 ) infile, oufile
      endif
      call open DOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSDOSƒDOSƒDOS…DOS…DOS‡DOS‡DOS‰DOS‰DOS‹DOS‹DOSDOSDOSDOSDOS‘DOS‘DOS“DOS“DOS•DOS•DOS—DOS—DOS™DOS™DOS›DOS›DOSDOSDOSŸDOSŸDOS¡DOS¡DOS£DOS£DOS¥DOS¥DOS§DOS§DOS©DOS©DOS«DOS«DOS­DOS­DOS¯DOS¯DOS±DOS±DOS³DOS³DOSµDOSµDOS·DOS·DOS¹DOS¹DOS»DOS»DOS½DOS½DOS¿DOS¿DOSÁDOSÁDOSÃDOSÃDOSÅDOSÅDOSÇDOSÇDOSÉDOSÉDOSËDOSËDOSÍDOSÍDOSÏDOSÏDOSÑDOSÑDOSÓDOSÓDOSÕDOSÕDOS×DOS×DOSÙDOSÙDOSÛDOSÛDOSİDOSİDOSßDOSßDOSáDOSáDOSãDOSãDOSåDOSåDOSçDOSçDOSéDOSéDOSëDOSëDOSíDOSíDOSïDOSïDOSñDOSñDOSóDOSóDOSõDOSõDOS÷DOS÷DOSùDOSùDOSûDOSûDOSıDOSıDOSÿDOSÿöööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööööö